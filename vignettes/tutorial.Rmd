---
title: "project3package Tutorial"
author: "Hadi Nazirool Bin Yusri, collaborated with Muhammad Anas"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{project3package Tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

### Introduction
- This package consist of 4 statistical function that developed through the course STAT 302 in University of Washington. The package can be install by the following line of code:
```{r setup}
library(magrittr)
library(dplyr)
library(FirstPackage)
library(kableExtra)
library(ggplot2)
```

```{r, eval = FALSE}
devtools::install_github("anasmuhd/FirstPackage", build_vignette = TRUE, build_opts = c())
```

### my_t.test
- my_t.test function will evaluate all hypothesis (less, greater, two side) of the data $lifeExp$ from $my\_gapminder$

$$H_0: \mu = 60$$
$$H_a: \mu \neq 60$$

$$\alpha = 0.05$$


# Test 1
```{r}
data(my_gapminder)
my_t.test(my_gapminder$lifeExp, "less", 60)

```
# Elaboration

# Test 2

```{r}
my_t.test(my_gapminder$lifeExp, "greater", 60)

```
# Elaboration

# Test 3

```{r}
my_t.test(my_gapminder$lifeExp, "two.sided", 60)

```
# Elaboration

### my_lm

# Explanation

```{r}
my_model <- my_lm(lifeExp ~ gdpPercap * continent, 
                my_gapminder[c("lifeExp", "gdpPercap", "continent")])
my_model
```

# Elaboration

```{r}
lm_fit <- lm(lifeExp ~ gdpPercap * continent, 
             my_gapminder[c("lifeExp", "gdpPercap", "continent")])
mod_fits <- fitted(lm_fit)
my_df <- data.frame(actual = my_gapminder$lifeExp, fitted = mod_fits)
ggplot(my_df, aes(x = fitted, y = actual)) +
  geom_point() +
  geom_abline(slope = 1, intercept = 0, col = "red", lty = 2) + 
  theme_bw(base_size = 12) +
  labs(x = "Fitted values", y = "Actual values", title = "Actual vs. Fitted") +
  theme(plot.title = element_text(hjust = 0.5))
```

# Elaboration

### my_knn_cv

# This function ....
# Input ....

```{r}

covariates <- my_penguins[c("bill_length_mm", "bill_depth_mm", 
                            "flipper_length_mm", "body_mass_g")]
class <- my_penguins[["species"]]
cv_errs <- vector(length = 10)
train_errs <- vector(length = 10)
for (i in 1:10) {
  cv_errs[i] <- my_knn_cv(covariates, class, i, 5)$cv_err
  # Count how many data points are misclassified using normal knn
  train_errs[i] <- 
    length(which(class::knn(covariates, covariates, class, i) != class)) / 
    nrow(my_penguins)
}
# Show table of errors
err_df <- cbind(1:10, data.frame(cv_errs), data.frame(train_errs))
colnames(err_df) <- c("k_nn", "cv_errs", "train_errs")
err_df
```

### my_rf_cv




